# Standard installation pathnames
# See the file LICENSE for the license
SHELL 		= @SHELL@
srcdir 		= @srcdir@
prefix  	= @prefix@
exec_prefix 	= @exec_prefix@
bindir 		= @bindir@
mandir 		= @mandir@

CC 		= @CC@
CPPFLAGS	= @CPPFLAGS@ @DEFS@ -I$(srcdir)
OURCFLAGS	= -Wall -W -Wwrite-strings #-Wunused-value -Wunused-parameter
CFLAGS 		= @CFLAGS@ $(OURCFLAGS)
LDFLAGS		= @LDFLAGS@
LIBS 		= @LIBS@

#INSTALL = $(srcdir)/install-sh -c
#INSTALL_PROGRAM = $(INSTALL)

LIBDNS_SOURCES=rdata.c util.c rr.c
LIBDNS_HEADERS=rdata.h prototype.h rr.h packet.h
LIBDNS_OBJECTS=$(LIBDNS_SOURCES:.c=.o)

ALL_SOURCES=run-test0.c $(LIBDNS_SOURCES)

COMPILE		= $(CC) $(CPPFLAGS) $(CFLAGS)
LINK		= $(CC) $(CFLAGS) $(LDFLAGS)

%.o:	%.c
	$(COMPILE) -c $<

.PHONY:	clean realclean

all:	run-test0

run-test0:	run-test0.o $(LIBDNS_OBJECTS)
		$(LINK) -o $@ $+

clean:	
	rm -f *.o *.d
	rm -f main
	rm -rf autom4te.cache/
	rm -f aclocal.m4

realclean: clean
	rm -f config.status
	rm -f config.log
	rm -f Makefile
	rm -f config.h
	rm -f config.h.in
	rm -f configure

# Automatic dependencies.
%.d: %.c
	$(SHELL) -ec '$(CC) -MM $(CPPFLAGS) $< \
	              | sed '\''s!\(.*\)\.o[ :]*!$(dir $@)\1.o $@ : !g'\'' > $@; \
	              [ -s $@ ] || rm -f $@'

include $(ALL_SOURCES:.c=.d)
