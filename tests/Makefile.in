# Standard installation pathnames
# See the file LICENSE for the license
SHELL = @SHELL@
VERSION = @PACKAGE_VERSION@
basesrcdir = $(shell basename `pwd`)
srcdir = @srcdir@
prefix  = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
mandir = @mandir@

CC = @CC@
CFLAGS = @CFLAGS@
CPPFLAGS = @CPPFLAGS@
LDFLAGS = @LDFLAGS@
LIBS = @LIBS@

COMPILE         = $(CC) $(CPPFLAGS) $(CFLAGS)
LINK            = $(CC) $(CFLAGS) $(LDFLAGS) $(LIBS)

HEADER		= config.h
TESTS		= run-test0 run-test7 run-test18 run-test19 run-test20 \
			dname-label-test notify \
			rrsig-test serial server

.PHONY:	all clean realclean

all:	$(TESTS)

run-test0:       run-test0.o 
		$(LINK) -o $@ $+ 

run-test7:        run-test7.o 
		$(LINK) -o $@ $+ 

run-test11:       run-test11.o 
		$(LINK) -o $@ $+ 

run-test18:       run-test18.o 
		$(LINK) -lssl -o $@ $+ 

run-test19:       run-test19.o 
		$(LINK) -lssl -o $@ $+ 

run-test20:       run-test20.o 
		$(LINK) -lssl -o $@ $+ 

rrsig-test:   rrsig-test.o
		$(LINK) -lssl -o $@ $+ 
	
dname-label-test:       dname-label-test.o 
		$(LINK) -o $@ $+ 
	
notify: 	notify.o
		$(LINK) -o $@ $+

serial: 	serial.o
		$(LINK) -o $@ $+

server: 	server.o
		$(LINK) -o $@ $+

## implicit rule
#%.o:    %.c $(HEADER)
#	$(COMPILE) -c $<
%.o:
	$(COMPILE) -c $(srcdir)/$*.c

clean:
	rm -f *.o
	rm -f $(TESTS)
	rm -f lua-rns

realclean: clean
	rm -rf autom4te.cache/
	rm -f config.log config.status aclocal.m4 config.h.in configure Makefile
	rm -f config.h

confclean: clean
	rm -rf config.log config.status config.h Makefile
