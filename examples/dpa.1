.TH dpa 1 "1 Nov 2005"
.SH NAME
dpa \- DNS Packet Analyzer. Analyze DNS packets in ip trace files
.SH SYNOPSIS
.B dpa
[
.IR OPTION
]
.IR TRACEFILE 

.SH DESCRIPTION
\fBdpa\fR is used to analyze dns packets in trace files. It has 3 main options: count, filter, and count uniques (i.e. count all different occurences).

.SH OPTIONS
.TP
\fB-c\fR \fIexpressionlist\fR
Count occurrences of matching expressions

.TP
\fB-f\fR \fIexpression\fR
Filter: only process packets that match the expression

.TP
\fB-h\fR 
Show usage

.TP
\fB-p\fR
Show the total number of correct DNS packets, and percentage of -u and
-c values  (of the total of matching on the -f filter. if no filter is
given, percentages are on all correct dns packets)

.TP
\fB-of\fR \fIfile\fR
Write all packets (IP wire data) that match the -f flag to file.

.TP
\fB-s\fR
Show possible match names

.TP
\fB-s\fR \fImatchname\fR
show possible match operators and values for name

.TP
\fB-sf\fR
Print packets (in representation format) that match the -f filter. If no -f was given, print all correct dns packets.

.TP
\fB-u\fR \fImatchnamelist\fR
Count every occurence of every value of the matchname (for instance, count all packetsizes, see EXAMPLES).

.TP
\fB-um\fR \fInumber\fR
Only show the results from -u for values that occurred more than <number> times.

.TP
\fBv\fR \fIlevel\fR
Set verbosity to level (1-5, 5 being the highest). Mostly used for debugging.

.SH LIST AND MATCHES

A <matchnamelist> is a comma separated list of match names (use -s to see possible match names).
A <expressionlist> is a comma separated list of expressions.

An expression has the following form:
<expr>: (<expr>)
        <expr> | <expr>
        <expr> & <expr>
        <match>

<match>:        <matchname> <operator> <value>

See the -s option for possible matchnames, operators and values.

.SH EXAMPLES

.TP
dpa -u packetsize -p test.tr
Count all different packetsizes in test.tr and show the precentages.

.TP
dpa -f "edns=1&qr=0" -of edns.tr test.tr
Filter out all edns enable queries in test.tr and put them in edns.tr

.TP
dpa -f edns=1 -c tc=1 -u rcode test.tr
For all edns packets, count the number of truncated packets and all their rcodes in test.tr.

.TP
dpa -c tc=1,qr=0,qr=1,opcode=QUERY test.tr
For all packets, count the number of truncated packets, the number of packets with qr=0, the number of packets with qr=1 and the number of queries in test.tr.

.SH AUTHOR
Written by Jelte Jansen for NLnetLabs.

.SH REPORTING BUGS
Report bugs to <jelte@nlnetlabs.nl>. 

.SH COPYRIGHT
Copyright (C) 2005 NLnet Labs. This is free software. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE.
