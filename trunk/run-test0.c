/* 
 * test main.c
 *
 */

#include <config.h>

#include <ldns/ldns.h>

#include "util.h"

/*
	0xc2, 0xb4, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01,
	0x00, 0x02, 0x00, 0x02, 0x03, 0x77, 0x77, 0x77,
	0x0b, 0x6b, 0x61, 0x6e, 0x61, 0x72, 0x69, 0x65,
	0x70, 0x69, 0x65, 0x74, 0x03, 0x63, 0x6f, 0x6d,
	0x00, 0x00, 0x01, 0x00, 0x01
};
*/
static const uint8_t wire[] = {
	0xd0, 0x0e, 0x81, 0x80, 0x00, 0x01, 0x00, 0x01, 0x00, 0x02, 0x00,
	0x02, 0x03, 0x77, 0x77, 0x77, 0x0b, 0x6b, 0x61, 0x6e, 0x61, 0x72,
	0x69, 0x65, 0x70, 0x69, 0x65, 0x74, 0x03, 0x63, 0x6f, 0x6d, 0x00,
	0x00, 0x01, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x01, 0x00, 0x01, 0x00,
	0x01, 0x45, 0xf2, 0x00, 0x04, 0xd5, 0x85, 0x27, 0xcf, 0xc0, 0x10,
	0x00, 0x02, 0x00, 0x01, 0x00, 0x01, 0x45, 0xf2, 0x00, 0x11, 0x03,
	0x6e, 0x73, 0x32, 0x08, 0x68, 0x65, 0x78, 0x6f, 0x6e, 0x2d, 0x69,
	0x73, 0x02, 0x6e, 0x6c, 0x00, 0xc0, 0x10, 0x00, 0x02, 0x00, 0x01,
	0x00, 0x01, 0x45, 0xf2, 0x00, 0x06, 0x03, 0x6e, 0x73, 0x31, 0xc0,
	0x45, 0xc0, 0x5e, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0xfb, 0x2e,
	0x00, 0x04, 0xd5, 0x85, 0x27, 0xcb, 0xc0, 0x41, 0x00, 0x01, 0x00,
	0x01, 0x00, 0x00, 0xfb, 0x2c, 0x00, 0x04, 0xd4, 0xcc, 0xdb, 0x5b
};

int
main(void)
{
	ldns_rdf *rd_f;
	ldns_rr *rr;
	ldns_pkt *packet;
	
	rr = ldns_rr_new();

	rd_f = _ldns_rdf_new(20, RD_DNAME_T, (uint8_t*)"hallo.nl");
	xprintf_rdf(rd_f);
	
	ldns_rr_push_rdf(rr, rd_f);

	xprintf_rr(rr);

	packet = ldns_pkt_new();
	(void) ldns_wire2pkt(packet, wire, sizeof(wire));
	
	printf("packet id: %d\n", (int) pkt_id(packet));
	printf("qr bit: %d\n", (int) pkt_qr(packet));
	printf("opcode: %d\n",(int) pkt_opcode(packet));
	printf("aa bit: %d\n",(int) pkt_aa(packet));
	printf("tc bit: %d\n",(int) pkt_tc(packet));
	printf("rd bit: %d\n",(int) pkt_rd(packet));
	printf("cd bit: %d\n",(int) pkt_cd(packet));
	printf("ra bit: %d\n",(int) pkt_ra(packet));
	printf("ad bit: %d\n",(int) pkt_ad(packet));
	printf("rcode: %d\n",(int) pkt_rcode(packet));
	printf("qdcount: %d\n",(int) pkt_qdcount(packet));
	printf("ancount: %d\n",(int) pkt_ancount(packet));
	printf("nscount: %d\n",(int) pkt_nscount(packet));
	printf("arcount: %d\n",(int) pkt_arcount(packet));

	ldns_pkt_free(packet);
	return 0;
}
